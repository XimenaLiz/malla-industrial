<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Malla Curricular - ULIMA</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
      margin: 0;
      padding: 2rem;
      background: #f6f5fa;
    }
    h1 {
      text-align: center;
      margin-bottom: 1rem;
      color: #5d3d9c;
    }
    .tabs {
      display: flex;
      justify-content: center;
      margin-bottom: 1.5rem;
      gap: 1rem;
    }
    .tabs button {
      padding: 0.5rem 1rem;
      background: #e0ddf5;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
      font-weight: 600;
      color: #5d3d9c;
    }
    .tabs button.active {
      background: #7c66e3;
      color: white;
    }
    .grid {
      display: flex;
      gap: 1.5rem;
      overflow-x: auto;
      padding-bottom: 1rem;
    }
    .ciclo-col {
      min-width: 250px;
      flex-shrink: 0;
      background-color: #ffffff;
      border-radius: 1.5rem;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.05);
      padding: 1rem;
    }
    .ciclo-title {
      font-weight: 600;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: #5d3d9c;
      text-align: center;
    }
    .curso {
      background-color: #e9ecfb;
      border-left: 6px solid #7c66e3;
      padding: 0.75rem;
      border-radius: 1rem;
      margin-bottom: 0.75rem;
      position: relative;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .curso.completado {
      text-decoration: line-through;
      opacity: 0.4;
    }
    .curso.bloqueado {
      opacity: 0.3;
    }
    .info-btn {
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      background-color: #7c66e3;
      color: white;
      border-radius: 50%;
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      cursor: pointer;
      z-index: 2;
    }
    .action-btn {
      position: absolute;
      bottom: 0.5rem;
      right: 0.5rem;
      display: flex;
      gap: 0.3rem;
    }
    .action-btn button {
      border: none;
      background: transparent;
      cursor: pointer;
      font-size: 14px;
      color: #5d3d9c;
    }
    .popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #ffffff;
      padding: 1.5rem;
      box-shadow: 0 10px 25px rgba(0,0,0,0.3);
      border-radius: 1.5rem;
      z-index: 99;
      max-width: 450px;
      width: 90%;
    }
    .popup h3 {
      margin-top: 0;
      color: #5d3d9c;
    }
    .popup small {
      display: block;
      margin-bottom: 0.5rem;
      color: #444;
    }
    .popup button {
      margin-top: 1rem;
      padding: 0.5rem 1rem;
      background-color: #5d3d9c;
      color: white;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
    }
    .overlay {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0, 0, 0, 0.3);
      z-index: 98;
    }
    .hidden { display: none; }
    .curso-title {
      font-weight: 600;
      color: #333;
    }
    .alerta-desbloqueo {
      position: fixed;
      bottom: 2rem;
      left: 50%;
      transform: translateX(-50%);
      background: #7c66e3;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 1rem;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
      z-index: 100;
      animation: fadeInOut 3s ease forwards;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .alerta-desbloqueo img {
      width: 24px;
      height: 24px;
    }
    @keyframes fadeInOut {
      0% { opacity: 0; }
      10% { opacity: 1; }
      90% { opacity: 1; }
      100% { opacity: 0; }
    }
    form {
      margin-top: 2rem;
      background: #fff;
      padding: 1rem;
      border-radius: 1rem;
      max-width: 550px;
      margin-left: auto;
      margin-right: auto;
      box-shadow: 0 0 15px rgba(0,0,0,0.05);
    }
    form input, form textarea {
      width: 97%;
      margin-bottom: 1rem;
      padding: 0.5rem;
      border-radius: 0.5rem;
      border: 1px solid #ccc;
    }
    form button {
      background: #5d3d9c;
      color: white;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 0.5rem;
      cursor: pointer;
    }
    .electivo {
      background-color: #ffe9ec;
      border-left: 6px solid #d94e6a;
      padding: 0.75rem;
      border-radius: 1rem;
      margin-bottom: 0.75rem;
      position: relative;
      cursor: grab;
      width: 220px;
    }
    .electivo.dragging {
      opacity: 0.4;
    }
    .electivo .info-btn {
      background-color: #d94e6a;
    }
    .electivo-dropzone {
      min-width: 250px;
      flex-shrink: 0;
      background-color: #fff4f5;
      border-radius: 1.5rem;
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.05);
      padding: 1rem;
    }
    .electivo-title {
      font-weight: 600;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      color: #d94e6a;
      text-align: center;
    }
    .electivos-flex {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      padding: 1rem;
      margin-bottom: 2rem;
    }
  #electivos-contenedor {
  margin-top: 40px;
}

.cursos-electivos-flex {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  justify-content: flex-start;
}
/* Estilo para distintivos de diplomas */
.badge {
  display: inline-block;
  font-size: 12px;
  background-color: #ccc;
  color: white;
  padding: 2px 6px;
  border-radius: 8px;
  margin-left: 6px;
  font-weight: 600;
}

/* Colores por diploma */
.badge.IT { background-color: #7b9acc; }       /* Innovaci√≥n Tecnol√≥gica */
.badge.BA { background-color: #e88941; }       /* Business Analytics */
.badge.SCM { background-color: #4dbf98; }      /* Supply Chain */
.badge.EPM { background-color: #c875c4; }      /* Engineering Project Mgmt */
.badge.IE { background-color: #f1b21d; }       /* Ingenier√≠a Empresarial */
.badge.ninguno { background-color: #aaa; }     /* Sin diploma */

/* Filtro Toggle de diplomas */
.filtros-diplomas {
  display: flex;
  gap: 0.5rem;
  justify-content: center;
  flex-wrap: wrap;
  margin-bottom: 1.5rem;
}

.filtros-diplomas button {
  background-color: #e0ddf5;
  color: #5d3d9c;
  border: none;
  padding: 0.4rem 0.8rem;
  border-radius: 1rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.filtros-diplomas button.active {
  background-color: #5d3d9c;
  color: white;
}
.badge {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 12px;
  font-size: 0.7rem;
  margin-top: 4px;
  margin-bottom: 6px;
  background-color: #ccc;
  color: white;
}
.badge.IT { background-color: #4caf50; }     /* Verde */
.badge.BA { background-color: #2196f3; }     /* Azul */
.badge.SCM { background-color: #ff9800; }    /* Naranja */
.badge.EPM { background-color: #9c27b0; }    /* P√∫rpura */
.badge.IE { background-color: #f44336; }     /* Rojo */
.badge.ninguno { background-color: #607d8b; }/* Gris */
.filtros-diplomas {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.5rem;
  margin: 1rem auto;
}
.filtros-diplomas button {
  padding: 0.5rem 1rem;
  background: #eee;
  border: none;
  border-radius: 1rem;
  cursor: pointer;
  transition: 0.2s;
}
.filtros-diplomas button:hover {
  background: #ddd;
}
.filtros-diplomas button.active {
  background: #5d3d9c;
  color: white;
}
.electivo {
  padding: 0.5rem 0.6rem;
  margin-bottom: 0.6rem;
  font-size: 0.85rem;
  line-height: 1.2;
}

.electivo .curso-title {
  font-size: 0.90rem;
  margin-bottom: 0.25rem;
}

.electivo small {
  font-size: 0.7rem;
  color: #444;
  line-height: 1.1;
}
.electivo .curso-title {
  padding-right: 30px; /* espacio para que no choque con el √≠cono */
  display: block;
  word-wrap: break-word; /* permite que el texto largo se divida si es necesario */
}
.alerta-creditos {
  background-color: #fff3cd;
  border: 1px solid #ffeeba;
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  color: #856404;
  font-size: 0.95em;
}
.alerta-sirena {
  color: red;
  font-size: 1.2em;
  margin-right: 5px;
  animation: parpadeo 1.2s infinite;
  vertical-align: middle;
}

@keyframes parpadeo {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.2; }
}
.popup-tabs {
  display: flex;
  margin-bottom: 1rem;
  gap: 0.5rem;
}

.popup-tabs .tab-button {
  flex: 1;
  padding: 0.6rem;
  background: #e0ddf5;
  color: #5d3d9c;
  border: none;
  border-radius: 0.75rem 0.75rem 0 0;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.3s;
}

.popup-tabs .tab-button.active {
  background: #7c66e3;
  color: white;
}

.tab-content {
  display: none;
  padding: 1rem;
  border: 2px solid #7c66e3;
  border-top: none;
  border-radius: 0 0 0.75rem 0.75rem;
  background: #f6f5fa;
}

.tab-content.active {
  display: block;
}
  </style>
</head>
<body>
  <h1>Malla Curricular - ULIMA</h1>
  <div id="creditos-container" style="margin: 1rem auto; max-width: 500px; text-align: center;">
  <div id="creditos-texto" style="font-weight: bold; margin-bottom: 0.5rem;">Cr√©ditos aprobados: 0 / 200</div>
  <div style="background: #eee; height: 20px; border-radius: 10px; overflow: hidden;">
    <div id="creditos-barra" style="height: 100%; width: 0%; background: #4caf50; transition: width 0.3s;"></div>
  </div>
</div>

  <div class="tabs" id="carreras">
    <button class="active" onclick="cambiarCarrera('ingenieria')">Ingenier√≠a Industrial</button>
  <button onclick="cambiarCarrera('personalizada')">Personalizada</button>
  </div>
  <div class="grid" id="malla"></div>

  <form id="formulario-personalizado" class="hidden" onsubmit="agregarCurso(event)">
    <h3>Agregar curso personalizado</h3>
    <input type="text" id="curso-nombre" placeholder="Nombre del curso" required>
    <input type="text" id="curso-codigo" placeholder="C√≥digo del curso">
    <input type="number" id="curso-creditos" placeholder="Cr√©ditos" required>
    <input type="number" id="curso-ciclo" placeholder="Ciclo" required>
    <input type="text" id="curso-prerreq" placeholder="Prerrequisitos (separados por coma)">
    <textarea id="curso-descripcion" placeholder="Descripci√≥n del curso"></textarea>
    <button type="submit">Agregar curso</button>
  </form>

<div id="overlay" class="overlay hidden"></div>
<div id="popup" class="popup hidden"></div>

<!-- Cursos Electivos sin agrupaci√≥n -->
<div id="electivos-contenedor" style="margin-top: 2rem;">
<h2 style="text-align: center; color: #5d3d9c;">Cursos Electivos</h2>
<!-- Filtros por diploma -->
<div class="filtros-diplomas">
  <button onclick="filtrarDiploma('todos')" class="active">Todos</button>
  <button onclick="filtrarDiploma('IT')">Innovaci√≥n Tecnol√≥gica</button>
  <button onclick="filtrarDiploma('BA')">Business Analytics</button>
  <button onclick="filtrarDiploma('SCM')">Supply Chain Mgmt</button>
  <button onclick="filtrarDiploma('EPM')">Engineering PM</button>
  <button onclick="filtrarDiploma('IE')">Ing. Empresarial</button>
  <button onclick="filtrarDiploma('Sin Diploma')">Sin Diploma</button>
</div>

<div id="electivos-container" class="electivos-flex"></div>
</div>

  <footer style="text-align: center; font-size: 0.85rem; color: #666; margin-top: 2rem;">
    <p>
      Creado por <strong>Adriana Lizares</strong> ‚ù§Ô∏è<br>
      Contacto: <a href="mailto:soportemallainteractiva@gmail.com">soportemallainteractiva@gmail.com</a><br>
      √öltima actualizaci√≥n: <span id="fecha-actualizacion"></span>
    </p>
  </footer>

  <script>
    document.getElementById("fecha-actualizacion").textContent = new Date().toLocaleDateString("es-PE", {
      year: 'numeric', month: 'long', day: 'numeric'
    });

    const carreras = {
      ingenieria: [
        { ciclo: 1, curso: "Matem√°tica b√°sica", codigo: "6382", creditos: 5, prerrequisitos: [], descripcion: "Conjuntos de n√∫meros reales, ecuaciones e inecuaciones, geometr√≠a anal√≠tica y funciones. Se enfatizan, asimismo, las representaciones gr√°ficas en el plano cartesiano y en el tratamiento introductorio a las funciones reales." },
        { ciclo: 1, curso: "Metodolog√≠as de la Investigaci√≥n", codigo: "6508", creditos: 3, prerrequisitos: [], descripcion: "Busca desarrollar en los estudiantes la capacidad de formular, desarrollar y comunicar proyectos de investigaci√≥n s√≥lidos y pertinentes, tanto en el √°mbito acad√©mico como profesional. Se centra en el dominio de t√©cnicas e instrumentos del m√©todo cient√≠fico, promoviendo el pensamiento cr√≠tico y objetivo." },
        { ciclo: 1, curso: "Desarrollo Personal y Social", codigo: "6505", creditos: 3, prerrequisitos: [], descripcion: "Conocer las principales caracter√≠sticas y procesos cognitivos y afectivos que explican el comportamiento humano a nivel individual y social. Permite al estudiante optimizar la comprensi√≥n de s√≠ mismo y de su entorno mediante el an√°lisis de casos." },
        { ciclo: 1, curso: "Lenguaje y Comunicaci√≥n I", codigo: "510003", creditos: 4, prerrequisitos: [], descripcion: "Promueve la comprensi√≥n lectora de textos acad√©micos, la redacci√≥n de textos expositivos, la expresi√≥n oral y la participaci√≥n en la vida acad√©mica. Se ense√±a gram√°tica, ortograf√≠a y estrategias de redacci√≥n propias del registro formal." },
        { ciclo: 1, curso: "Introducci√≥n a la Ingenier√≠a", codigo: "510005", creditos: 3, prerrequisitos: [], descripcion: "Conocer las principales caracter√≠sticas y procesos del comportamiento humano en la ingenier√≠a. Permite optimizar la comprensi√≥n de uno mismo y del entorno desde una perspectiva profesional." },
        { ciclo: 1, curso: "√âtica c√≠vica", codigo: "510004", creditos: 2, prerrequisitos: [], descripcion: "Incentiva la reflexi√≥n sobre valores esenciales para la convivencia en sociedades actuales y el an√°lisis cr√≠tico de problemas sociales desde un enfoque √©tico-c√≠vico. Promueve el di√°logo y la responsabilidad social en contextos universitarios." },
        
        { ciclo: 2, curso: "C√°lculo I", codigo: "6503", creditos: 5, prerrequisitos: ["Matem√°tica b√°sica"], descripcion: "Desarrolla habilidades de razonamiento l√≥gico mediante el c√°lculo diferencial e integral en una variable real. Incluye funciones trigonom√©tricas, l√≠mites, derivadas e integrales." },
        { ciclo: 2, curso: "√Ålgebra Lineal", codigo: "6384", creditos: 3, prerrequisitos: ["Matem√°tica b√°sica"], descripcion: "Desarrolla competencias para resolver problemas de ingenier√≠a con vectores y matrices. Aborda √°lgebra vectorial y matricial." },
        { ciclo: 2, curso: "Econom√≠a y Empresa", codigo: "6510", creditos: 3, prerrequisitos: [], descripcion: "Proporciona los lineamientos b√°sicos del an√°lisis econ√≥mico y empresarial. Incluye teor√≠a econ√≥mica general y elementos b√°sicos de la empresa." },
        { ciclo: 2, curso: "Lenguaje y Comunicaci√≥n II", codigo: "6511", creditos: 3, prerrequisitos: ["Lenguaje y Comunicaci√≥n I"], descripcion: "Consolida habilidades lectoras y desarrolla competencias para la redacci√≥n de textos expositivos y argumentativos, y expresi√≥n oral formal. Reflexiona sobre las lenguas y el discurso." },
        { ciclo: 2, curso: "Procesos Sociales y Pol√≠ticos", codigo: "6512", creditos: 3, prerrequisitos: [], descripcion: "Aplica herramientas de las ciencias sociales para comprender la sociedad. Analiza cr√≠ticamente procesos sociales y pol√≠ticos actuales, con √©nfasis en Sociolog√≠a y Antropolog√≠a." },
        { ciclo: 2, curso: "Temas de Filosof√≠a", codigo: "6513", creditos: 3, prerrequisitos: [], descripcion: "Introduce al pensamiento filos√≥fico mediante la exploraci√≥n de problemas del conocimiento, conciencia, moral y sentido de la vida. Fomenta el razonamiento cr√≠tico-aut√≥nomo." },
        
        { ciclo: 3, curso: "Inteligencia Artificial aplicada", codigo: "560040", creditos: 3, prerrequisitos: [], descripcion: "Aplica los principios fundamentales y herramientas de Inteligencia Artificial en problemas espec√≠ficos de ingenier√≠a. Aborda fundamentos de IA, programaci√≥n b√°sica, dise√±o de ingenier√≠a, IA generativa y desaf√≠os √©ticos." },
        { ciclo: 3, curso: "F√≠sica I", codigo: "560041", creditos: 5, prerrequisitos: ["C√°lculo I"], descripcion: "Explica los principios f√≠sicos fundamentales como vectores, cinem√°tica, din√°mica, energ√≠a, momento, oscilaciones, ondas, fluidos y termodin√°mica, base para la pr√°ctica de la ingenier√≠a." },
        { ciclo: 3, curso: "Qu√≠mica general", codigo: "5643", creditos: 4, prerrequisitos: [], descripcion: "Explica los principios de la qu√≠mica moderna y su relaci√≥n con otras ciencias. Aborda interacciones qu√≠micas, reacciones y leyes que rigen estas interacciones en soluci√≥n y fase gaseosa." },
        { ciclo: 3, curso: "C√°lculo II", codigo: "560042", creditos: 5, prerrequisitos: ["C√°lculo I"], descripcion: "Explica integrales y series infinitas. Incluye t√©cnicas de integraci√≥n, convergencia de series, representaci√≥n de funciones como series de potencias y coordenadas polares." },
        { ciclo: 3, curso: "Sistemas Organizacionales", codigo: "560038", creditos: 2, prerrequisitos: ["Econom√≠a y Empresa"], descripcion: "Aplica procedimientos para expresar sistemas organizacionales y subsistemas. Aborda Lenguajes de Modelado Unificado y conceptos de organizaci√≥n desde el enfoque funcional." },
        { ciclo: 3, curso: "Dise√±o asistido por el Computador", codigo: "560039", creditos: 3, prerrequisitos: ["√Ålgebra Lineal"], descripcion: "Explica t√©cnicas de modelado mec√°nico usando software CAD. Aborda modelado 3D, planos 2D, est√°ndares de dibujo de ingenier√≠a y animaci√≥n/simulaci√≥n b√°sicas." },
        
        { ciclo: 4, curso: "Costeo de Operaciones", codigo: "560043", creditos: 3, prerrequisitos: ["Sistemas Organizacionales"], descripcion: "Aplica conceptos de costos para determinar el valor econ√≥mico de operaciones. Aborda estados financieros, sistemas de costeo y elaboraci√≥n de presupuestos." },
        { ciclo: 4, curso: "Fundamentos de Programaci√≥n", codigo: "560044", creditos: 3, prerrequisitos: ["Inteligencia Artificial aplicada"], descripcion: "Dise√±a algoritmos simples mediante lenguajes de programaci√≥n. Aborda estructuras de control b√°sicas, subrutinas, dise√±o de modelos basados en datos e IA." },
        { ciclo: 4, curso: "F√≠sica II", codigo: "560045", creditos: 5, prerrequisitos: ["F√≠sica I"], descripcion: "Explica fen√≥menos electromagn√©ticos y estructura de la materia. Aborda circuitos de corriente, magnetismo, √≥ptica y fundamentos de f√≠sica moderna." },
        { ciclo: 4, curso: "Estad√≠stica y Probabilidad", codigo: "560046", creditos: 4, prerrequisitos: ["C√°lculo I"], descripcion: "Explica t√©cnicas de estad√≠stica descriptiva e inferencial. Aborda probabilidad, variables aleatorias, distribuciones, modelos y estimaci√≥n de par√°metros." },
        { ciclo: 4, curso: "Mec√°nica", codigo: "5647", creditos: 4, prerrequisitos: ["F√≠sica I", "Dise√±o asistido por el Computador"], descripcion: "Dise√±a elementos estructurales aplicando principios de Est√°tica y Mec√°nica de Materiales. Aborda equilibrio en vigas y marcos, esfuerzos y deformaciones." },
        { ciclo: 4, curso: "C√°lculo III", codigo: "560047", creditos: 3, prerrequisitos: ["C√°lculo II"], descripcion: "Aplica t√©cnicas de c√°lculo diferencial e integral en varias variables. Aborda curvas y superficies en el espacio y c√°lculo vectorial." },

        { ciclo: 5, curso: "Investigaci√≥n de Operaciones I", codigo: "560048", creditos: 4, prerrequisitos: ["Fundamentos de Programaci√≥n"], descripcion: "Elabora modelos estructurados para resolver problemas de programaci√≥n lineal. Aborda programaci√≥n lineal, m√©todo simplex, dualidad, programaci√≥n entera, mixta y por objetivos." },
        { ciclo: 5, curso: "Fundamentos de Operaciones y Log√≠stica", codigo: "560049", creditos: 4, prerrequisitos: ["Costeo de Operaciones"], descripcion: "Explica los fundamentos de la gesti√≥n de operaciones. Aborda productividad, calidad, mantenimiento y log√≠stica." },
        { ciclo: 5, curso: "Ingenier√≠a Econ√≥mica", codigo: "560050", creditos: 4, prerrequisitos: ["Costeo de Operaciones"], descripcion: "Aplica herramientas de matem√°tica financiera basadas en el valor del dinero en el tiempo. Aborda tasas de inter√©s, decisiones financieras, an√°lisis de reemplazo y sensibilidad." },
        { ciclo: 5, curso: "Electricidad y Electr√≥nica", codigo: "560051", creditos: 3, prerrequisitos: ["F√≠sica II"], descripcion: "Explica los principales conceptos el√©ctricos y electr√≥nicos. Aborda circuitos AC y DC, energ√≠a el√©ctrica, m√°quinas el√©ctricas y semiconductores." },
        { ciclo: 5, curso: "Ecuaciones diferenciales", codigo: "560052", creditos: 3, prerrequisitos: ["C√°lculo III"], descripcion: "Desarrolla ecuaciones diferenciales ordinarias y sistemas. Aborda integraci√≥n directa, m√©todos num√©ricos, transformada de Laplace y series de potencias." },
        { ciclo: 5, curso: "Dise√±o de Experimentos", codigo: "560053", creditos: 4, prerrequisitos: ["Estad√≠stica y Probabilidad"], descripcion: "Explica t√©cnicas de an√°lisis estad√≠stico. Aborda pruebas de hip√≥tesis, modelos de regresi√≥n lineal y log√≠stica, intervalos de confianza y estimaciones." },

        { ciclo: 6, curso: "Investigaci√≥n de operaciones II", codigo: "560054", creditos: 4, prerrequisitos: ["Investigaci√≥n de Operaciones I"], descripcion: "Resuelve problemas de incertidumbre con m√©todos de IO. Aborda modelos probabil√≠sticos, cadenas de Markov, colas e inventarios con simulaci√≥n Montecarlo." },
        { ciclo: 6, curso: "Ergonom√≠a y Dise√±o del Trabajo", codigo: "560055", creditos: 4, prerrequisitos: ["Estad√≠stica y Probabilidad"], descripcion: "Dise√±a sistemas hombre-m√°quina considerando normas de ergonom√≠a. Aborda factores humanos, estaciones de trabajo y seguridad ocupacional." },
        { ciclo: 6, curso: "Innovaci√≥n en Ingenier√≠a", codigo: "560056", creditos: 3, prerrequisitos: ["Electricidad y Electr√≥nica", "Mec√°nica"], descripcion: "Implementa proyectos de ingenier√≠a. Aborda programaci√≥n de microcontroladores, dise√±o CAD y simulaci√≥n FEA." },
        { ciclo: 6, curso: "Planeamiento y Control de Operaciones", codigo: "560012", creditos: 4, prerrequisitos: ["Fundamentos de Operaciones y Log√≠stica"], descripcion: "Eval√∫a sistemas de planificaci√≥n y producci√≥n. Aborda pron√≥sticos, MRP, JIT/Kanban, programaci√≥n y teor√≠a de restricciones." },
        { ciclo: 6, curso: "Procesos Industriales", codigo: "560057", creditos: 4, prerrequisitos: ["Qu√≠mica general", "F√≠sica II"], descripcion: "Aplica principios de conservaci√≥n de materia y energ√≠a. Aborda balances, operaciones unitarias, movimiento de fluidos y transferencia de calor." },

        { ciclo: 7, curso: "Ingenier√≠a Financiera", codigo: "560058", creditos: 3, prerrequisitos: ["Ingenier√≠a Econ√≥mica"], descripcion: "Eval√∫a la situaci√≥n financiera de organizaciones empresariales. Aborda financiamiento, gesti√≥n de riesgos, an√°lisis burs√°til y optimizaci√≥n de portafolios." },
        { ciclo: 7, curso: "Dise√±o de Instalaciones", codigo: "560059", creditos: 3, prerrequisitos: ["Ergonom√≠a y Dise√±o del Trabajo"], descripcion: "Dise√±a instalaciones en empresas manufactureras y de servicios. Aborda c√°lculo de tama√±o de planta, localizaci√≥n, layout (SLP) y herramientas Lean." },
        { ciclo: 7, curso: "Inteligencia de Negocios", codigo: "560060", creditos: 3, prerrequisitos: ["Investigaci√≥n de Operaciones I", "Fundamentos de Operaciones y Log√≠stica", "Ingenier√≠a Econ√≥mica", "Electricidad y Electr√≥nica", "Ecuaciones diferenciales", "Dise√±o de Experimentos"], descripcion: "Eval√∫a procesos de negocios mediante an√°lisis de datos. Aborda recopilaci√≥n, depuraci√≥n, an√°lisis y comunicaci√≥n de datos con plataformas de inteligencia empresarial." },
        { ciclo: 7, curso: "Modelos de Sistemas Log√≠sticos", codigo: "560061", creditos: 4, prerrequisitos: ["Fundamentos de Operaciones y Log√≠stica"], descripcion: "Construye sistemas de suministro. Aborda funci√≥n log√≠stica, desempe√±o (KPIs), administraci√≥n de demanda, pedidos, distribuci√≥n e inventarios." },
        { ciclo: 7, curso: "Calidad", codigo: "560062", creditos: 3, prerrequisitos: ["Dise√±o de Experimentos"], descripcion: "Aplica herramientas de calidad. Aborda control estad√≠stico, gr√°ficos de control, muestreo, Six Sigma y metodolog√≠a DMAIC." },
        { ciclo: 7, curso: "Procesos de Manufactura", codigo: "560063", creditos: 3, prerrequisitos: ["Innovaci√≥n en Ingenier√≠a"], descripcion: "Dise√±a piezas mec√°nicas. Aborda procesos tradicionales y modernos de manufactura, ingenier√≠a aditiva y control num√©rico computarizado." },

        { ciclo: 8, curso: "Simulaci√≥n de Procesos", codigo: "560064", creditos: 4, prerrequisitos: ["Investigaci√≥n de Operaciones I"], descripcion: "Construye modelos de simulaci√≥n discreta. Aborda recolecci√≥n de datos, modelado, software de simulaci√≥n, an√°lisis estad√≠stico y comparaci√≥n de escenarios." },
        { ciclo: 8, curso: "Modelamiento Predictivo de Datos", codigo: "560065", creditos: 3, prerrequisitos: ["Inteligencia de Negocios"], descripcion: "Eval√∫a resultados de modelos de predicci√≥n. Aborda algoritmos estad√≠sticos, √°rboles de decisi√≥n, redes neuronales y clustering (k-medias)." },
        { ciclo: 8, curso: "Sistemas Integrados de Gesti√≥n", codigo: "560066", creditos: 3, prerrequisitos: ["Calidad"], descripcion: "Integra normas de seguridad, calidad y medio ambiente. Aborda interpretaci√≥n de requisitos, planificaci√≥n, auditor√≠as y mejora continua." },
        { ciclo: 8, curso: "Gesti√≥n de Proyectos", codigo: "560067", creditos: 3, prerrequisitos: ["Investigaci√≥n de operaciones II", "Ergonom√≠a y Dise√±o del Trabajo", "Planeamiento y Control de Operaciones", "Procesos Industriales", "Innovaci√≥n en Ingenier√≠a"], descripcion: "Elabora proyectos con enfoque PMBOK. Aborda fases de gesti√≥n, pr√°cticas predictivas y adaptativas, planificaci√≥n y control de proyectos." },
        { ciclo: 8, curso: "An√°lisis de Problemas de Ingenier√≠a", codigo: "560068", creditos: 3, prerrequisitos: ["Modelos de Sistemas Log√≠sticos", "Calidad"], descripcion: "Crea propuestas de mejora para procesos empresariales. Aborda diagn√≥stico, dise√±o de indicadores, evaluaci√≥n y resoluci√≥n de problemas." },
        { ciclo: 8, curso: "Automatizaci√≥n Industrial", codigo: "560069", creditos: 3, prerrequisitos: ["Procesos de Manufactura"], descripcion: "Aplica manufactura integrada por computador. Aborda CNC, FMS, CAD/CAM/CAE, control de procesos, redes y automatizaci√≥n industrial." },

        { ciclo: 9, curso: "√âtica y Gesti√≥n Humana", codigo: "560070", creditos: 3, prerrequisitos: [], descripcion: "Aplica conceptos √©ticos en la pr√°ctica de la ingenier√≠a, con √©nfasis en la gesti√≥n de talento humano. Aborda est√°ndares √©ticos, motivaci√≥n, rendimiento y compensaciones." },
        { ciclo: 9, curso: "Proyecto de Ingenier√≠a Aplicada I", codigo: "560071", creditos: 4, prerrequisitos: ["An√°lisis de Problemas de Ingenier√≠a"], descripcion: "Primera etapa de dise√±o de soluci√≥n ante un problema de ingenier√≠a. Aborda diagn√≥stico causa-ra√≠z, identificaci√≥n de oportunidades y dise√±o de modelos dentro de l√≠neas de investigaci√≥n." },
        { ciclo: 9, curso: "Ingenier√≠a Comercial", codigo: "560072", creditos: 3, prerrequisitos: ["Modelos de Sistemas Log√≠sticos"], descripcion: "Eval√∫a la gesti√≥n del proceso comercial usando herramientas innovadoras. Aborda segmentaci√≥n de mercados, comportamiento del consumidor, marketing, ventas y CRM." },

        { ciclo: 10, curso: "Proyecto de Ingenier√≠a Aplicada II", codigo: "560073", creditos: 4, prerrequisitos: ["Proyecto de Ingenier√≠a Aplicada I", "Simulaci√≥n de Procesos"], descripcion: "Segunda etapa del proyecto de ingenier√≠a. Eval√∫a viabilidad del modelo propuesto mediante simulaci√≥n cr√≠tica de un caso real." },
        { ciclo: 10, curso: "Gerencia Estrat√©gica", codigo: "560074", creditos: 4, prerrequisitos: ["Ingenier√≠a Financiera", "Ingenier√≠a Comercial"], descripcion: "Crea un plan estrat√©gico competitivo. Aborda an√°lisis estrat√©gico, formulaci√≥n de estrategias, Balanced Scorecard y modelo GRC." },
],

      personalizada: JSON.parse(localStorage.getItem("cursosPersonalizados")) || []
    };

    let carreraActual = 'ingenieria';
    const estadoCursos = JSON.parse(localStorage.getItem("estadoCursosULIMA")) || {};

    function guardarCursosPersonalizados() {
      localStorage.setItem("cursosPersonalizados", JSON.stringify(carreras.personalizada));
    }

    function lanzarConfetti() {
      confetti({ particleCount: 100, spread: 70, origin: { y: 0.6 } });
    }
    function cambiarTab(tab) {
  document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
  document.querySelectorAll(".tab-content").forEach(div => div.classList.remove("active", "hidden"));

  if (tab === "eval") {
    document.querySelector(".tab-button:nth-child(1)").classList.add("active");
    document.getElementById("tab-eval").classList.add("active");
  } else {
    document.querySelector(".tab-button:nth-child(2)").classList.add("active");
    document.getElementById("tab-notas").classList.add("active");
  }
}


    function mostrarAlerta(mensaje) {
      const alerta = document.createElement("div");
      alerta.className = "alerta-desbloqueo";
      alerta.innerHTML = `<img src="https://media.giphy.com/media/L0a0RgItTjX3WgYgKn/giphy.gif" alt="Desbloqueado"> <span>${mensaje}</span>`;
      document.body.appendChild(alerta);
      setTimeout(() => alerta.remove(), 3000);
    }
function renderPopup(curso) {
  const popup = document.getElementById("popup");
  const overlay = document.getElementById("overlay");
  const prerreq = curso.prerrequisitos.length ? curso.prerrequisitos.join(", ") : "Ninguno";
  const evaluaciones = JSON.parse(localStorage.getItem("evaluaciones_" + curso.curso)) || [];
  const notaGuardada = localStorage.getItem("nota_" + curso.curso) || "";

  let promedio = 0;
  let totalPeso = 0;
  evaluaciones.forEach(ev => {
    promedio += ev.peso * ev.nota;
    totalPeso += ev.peso;
  });
  promedio = totalPeso > 0 ? (promedio / totalPeso).toFixed(2) : "-";

  popup.innerHTML = `
    <div class="popup-tabs">
      <button class="tab-button active" onclick="cambiarTabPopup('info')"> Informaci√≥n</button>
      <button class="tab-button" onclick="cambiarTabPopup('eval')"> Evaluaciones</button>
      <button class="tab-button" onclick="cambiarTabPopup('notas')">üìù Notas</button>
    </div>

    <div id="tab-info" class="tab-content active">
      <h3>${curso.curso}</h3>
      <small><strong>C√≥digo:</strong> ${curso.codigo}</small><br>
      <small><strong>Cr√©ditos:</strong> ${curso.creditos}</small><br>
      <small><strong>Prerrequisitos:</strong> ${prerreq}</small>
      <p style="margin-top: 0.5em;">${curso.descripcion}</p>

      ${curso.curso === "Costeo de Operaciones" ? `
        <div style="background:#ffe9ec; color:#d94e6a; border-radius:0.5em; padding:0.8em; margin:1em 0;">
          <strong>‚ö†Ô∏è Nota importante:</strong><br>
          Si cursaste <b>Costeo de Operaciones</b> antes del ciclo 2025-1, el curso ten√≠a <b>2 cr√©ditos</b>.<br>
          Desde 2025-1 el curso tiene <b>3 cr√©ditos</b>.<br>
          Considera esto para tu avance curricular.
        </div>
      ` : ""}
    </div>

    <div id="tab-eval" class="tab-content hidden">
      <table style="width: 100%; border-collapse: collapse;">
        <thead>
          <tr><th>Evaluaci√≥n</th><th>%</th><th>Nota</th><th></th></tr>
        </thead>
        <tbody>
          ${evaluaciones.map((ev, i) => `
            <tr>
              <td>${ev.nombre}</td>
              <td>${(ev.peso * 100).toFixed(0)}%</td>
              <td>${ev.nota}</td>
              <td><button onclick="eliminarEval('${curso.curso}', ${i})">‚ùå</button></td>
            </tr>
          `).join("")}
        </tbody>
      </table>
      <form onsubmit="agregarEval(event, '${curso.curso}')" style="margin-top: 0.5em;">
        <input type="text" placeholder="Nombre" id="eval-nombre" required>
        <input type="number" placeholder="%" id="eval-peso" min="0" max="100" required>
        <input type="number" placeholder="Nota" id="eval-nota" step="0.1" min="0" max="20" required>
        <button type="submit">‚ûï Agregar</button>
      </form>
      <p><strong>Promedio:</strong> <span id="promedio-curso">${promedio}</span></p>
    </div>

    <div id="tab-notas" class="tab-content hidden">
      <textarea id="nota-personal" placeholder="Escribe tus notas personales aqu√≠..." rows="6" style="width: 100%;">${notaGuardada}</textarea>
    </div>

    <br><button onclick="cerrarPopup()">Cerrar</button>
  `;

  popup.querySelector("#nota-personal").addEventListener("input", e => {
    localStorage.setItem("nota_" + curso.curso, e.target.value);
  });

  popup.classList.remove("hidden");
  overlay.classList.remove("hidden");
}

    function cerrarPopup() {
      document.getElementById("popup").classList.add("hidden");
      document.getElementById("overlay").classList.add("hidden");
    }

    function cambiarCarrera(nombre) {
      document.querySelectorAll('.tabs button').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.tabs button[onclick*="${nombre}"]`).classList.add('active');
      carreraActual = nombre;
      document.getElementById("formulario-personalizado").classList.toggle("hidden", nombre !== "personalizada");
        if (nombre === "personalizada") {
        document.getElementById('electivos-contenedor').style.display = 'none';
      } else {
        document.getElementById('electivos-contenedor').style.display = '';
      }
      renderMalla();
    }

    function agregarCurso(e) {
      e.preventDefault();
      const nombre = document.getElementById("curso-nombre").value;
      const codigo = document.getElementById("curso-codigo").value;
      const creditos = parseInt(document.getElementById("curso-creditos").value);
      const cicloText = targetCol.querySelector(".ciclo-title")?.textContent || "";
      const ciclo = parseInt(cicloText.replace("Ciclo ", "")) || 1;
      const prerreq = document.getElementById("curso-prerreq").value.split(",").map(p => p.trim()).filter(Boolean);
      const descripcion = document.getElementById("curso-descripcion").value;
      carreras.personalizada.push({ curso: nombre, codigo, creditos, ciclo, prerrequisitos: prerreq, descripcion });
      guardarCursosPersonalizados();
      e.target.reset();
      renderMalla();
    }

    function editarCurso(nombre) {
      const curso = carreras.personalizada.find(c => c.curso === nombre);
      if (!curso) return;
      document.getElementById("curso-nombre").value = curso.curso;
      document.getElementById("curso-codigo").value = curso.codigo;
      document.getElementById("curso-creditos").value = curso.creditos;
      document.getElementById("curso-ciclo").value = curso.ciclo;
      document.getElementById("curso-prerreq").value = curso.prerrequisitos.join(", ");
      document.getElementById("curso-descripcion").value = curso.descripcion;
      carreras.personalizada = carreras.personalizada.filter(c => c.curso !== nombre);
      guardarCursosPersonalizados();
      renderMalla();
    }
    function cambiarTabPopup(tab) {
      document.querySelectorAll(".popup-tabs .tab-button").forEach(btn => btn.classList.remove("active"));
      document.querySelectorAll(".tab-content").forEach(div => div.classList.remove("active"));

      document.querySelector(`.popup-tabs .tab-button[onclick*="${tab}"]`).classList.add("active");
      document.getElementById(`tab-${tab}`).classList.add("active");
    }

    function eliminarCurso(nombre) {
      if (!confirm(`¬øEliminar "${nombre}"?`)) return;
      carreras.personalizada = carreras.personalizada.filter(c => c.curso !== nombre);
      guardarCursosPersonalizados();
      renderMalla();
    }
    const nombreDiploma = {
      IT: "Innovaci√≥n Tecnol√≥gica",
      BA: "Business Analytics",
      SCM: "Supply Chain Management",
      EPM: "Engineering Project Management",
      IE: "Ingenier√≠a Empresarial",
      ninguno: "Sin diploma"
    };
    function renderMalla() {
      let cursos = carreras[carreraActual];
      const container = document.getElementById("malla");
      const ciclos = [...new Set(cursos.map(c => c.ciclo))].sort((a,b) => a-b);
      container.innerHTML = "";

      cursos.forEach(curso => {
        const fueBloqueado = curso.prerrequisitos.some(pre => !estadoCursos[pre]);
        const ahoraDesbloqueado = curso.prerrequisitos.every(pre => estadoCursos[pre]);
        if (!estadoCursos[curso.curso] && fueBloqueado && ahoraDesbloqueado && localStorage.getItem("estadoCursosULIMA")) {
          mostrarAlerta(`¬°Ya puedes llevar \"${curso.curso}\"!`);
        }
      });

      ciclos.forEach(ciclo => {
        const col = document.createElement("div");
        col.className = "ciclo-col";
        col.innerHTML = `<div class="ciclo-title">Ciclo ${ciclo}</div>`;

      cursos
  .filter(c => c.ciclo === ciclo)
  .filter(curso => {
    // Si estamos en la pesta√±a personalizada, NO mostrar cursos electivos
    if (carreraActual === "personalizada") {
      return !cursosElectivos.some(e => e.curso === curso.curso);
    }
    return true;
  })
  .forEach(curso => {
          const card = document.createElement("div");
          card.className = "curso";
          if (cursosElectivos.some(e => e.curso === curso.curso)) {
              habilitarBotonEliminarElectivo(card, curso);
          }
          card.dataset.nombre = curso.curso;

          const creditosCompletados = Object.entries(estadoCursos)
            .filter(([_, aprobado]) => aprobado)
            .map(([nombre]) => {
              const cursoEncontrado = carreras[carreraActual].find(c => c.curso === nombre);
              return cursoEncontrado ? cursoEncontrado.creditos : 0;
            })
            .reduce((a, b) => a + b, 0);

          const estaBloqueado = curso.prerrequisitos.some(pre => {
            if (pre.startsWith("cr√©ditos:")) {
              const requeridos = parseInt(pre.split(":")[1]);
              return creditosCompletados < requeridos;
            }
            return !estadoCursos[pre];
          });
          if (estaBloqueado) card.classList.add("bloqueado");
          if (estadoCursos[curso.curso]) card.classList.add("completado");

let badge = "";
const electivoData = cursosElectivos.find(e => e.curso === curso.curso);
if (electivoData) {
  if (Array.isArray(electivoData.diploma)) {
    badge = electivoData.diploma.map(sigla =>
      `<span class="badge ${sigla}" title="${nombreDiploma[sigla] || sigla}">${sigla}</span>`
    ).join(" ");
  } else if (electivoData.diploma && electivoData.diploma !== "ninguno") {
    badge = `<span class="badge ${electivoData.diploma}" title="${nombreDiploma[electivoData.diploma] || electivoData.diploma}">${electivoData.diploma}</span>`;
  } else {
    badge = `<span class="badge ninguno" title="Sin diploma">Sin diploma</span>`;
  }
}
let alertaIcono = "";
if (curso.curso === "Costeo de Operaciones") {
  alertaIcono = `<span class="alerta-sirena" title="¬°Atenci√≥n! Cambi√≥ de 2 a 3 cr√©ditos desde 2025-1">üö®</span>`;
}

card.innerHTML = `
  <div class="curso-title">${alertaIcono} ${curso.curso}</div>
  ${badge}
  <small><strong>C√≥digo:</strong> ${curso.codigo}</small>
  <small><strong>Cr√©ditos:</strong> ${curso.creditos}</small>
  <div class="info-btn">i</div>
`;


          card.querySelector(".info-btn").addEventListener("click", e => {
            e.stopPropagation();
            renderPopup(curso);
          });

          if (carreraActual === 'personalizada') {
            const actions = document.createElement('div');
            actions.className = 'action-btn';
            actions.innerHTML = `
              <button onclick="event.stopPropagation(); editarCurso('${curso.curso}')">‚úèÔ∏è</button>
              <button onclick="event.stopPropagation(); eliminarCurso('${curso.curso}')">üóëÔ∏è</button>
            `;
            card.appendChild(actions);
          }
          else if (cursosElectivos.some(e => e.curso === curso.curso)) {
            const actions = document.createElement('div');
            actions.className = 'action-btn';
            actions.innerHTML = `
              <button onclick="event.stopPropagation(); quitarElectivo('${curso.curso}')">üîô Quitar</button>
            `;
            card.appendChild(actions);
          }
          card.addEventListener("click", () => {
            if (!estaBloqueado) {
              estadoCursos[curso.curso] = !estadoCursos[curso.curso];
              localStorage.setItem("estadoCursosULIMA", JSON.stringify(estadoCursos));
              renderMalla();
              if (estadoCursos[curso.curso]) lanzarConfetti();
            }
          });

          col.appendChild(card);
        });

        container.appendChild(col);
      });
      mostrarCreditosAprobados();
    }
    function mostrarCreditosAprobados() {
  const creditosTotales = 205; // ‚Üê Ajusta este n√∫mero si tu carrera tiene otro total
  const creditosCompletados = Object.entries(estadoCursos)
    .filter(([_, aprobado]) => aprobado)
    .map(([nombre]) => {
      const cursoEncontrado = carreras[carreraActual].find(c => c.curso === nombre);
      return cursoEncontrado ? cursoEncontrado.creditos : 0;
    })
    .reduce((a, b) => a + b, 0);

  const porcentaje = Math.min(100, Math.round((creditosCompletados / creditosTotales) * 100));

  document.getElementById("creditos-texto").textContent = `Cr√©ditos aprobados: ${creditosCompletados} / ${creditosTotales}`;
  document.getElementById("creditos-barra").style.width = `${porcentaje}%`;
}

    const cursosElectivos = [
  {
    ciclo: 10,
    curso: "TRANSFORMACI√ìN DIGITAL",
    codigo: "560081",
    creditos: 3,
    prerrequisitos: [
	"Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a una estrategia de digitalizaci√≥n para una organizaci√≥n. Esta asignatura aborda la importancia de la Transformaci√≥n Digital en el contexto actual, la innovaci√≥n y sus diversos tipos, big data (arquitectura, roles, tecnolog√≠as, lenguajes de programaci√≥n, machine learning), internet de las cosas, blockchain y econom√≠a de plataformas.",
    diploma: ["BA","IT"]
  },
  {
    ciclo: 8,
    curso: "INTRODUCCI√ìN A SISTEMAS DE GESTI√ìN DE BASES DE DATOS",
    codigo: "560082",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante resuelve problemas de la gesti√≥n de operaciones mediante el uso de base de datos. Esta asignatura emplea aulas de c√≥mputo y se aborda el dise√±o de bases de datos, la gesti√≥n de los datos, el desarrollo de consultas mediante software especializado y los aspectos relacionados a la protecci√≥n e integraci√≥n de los datos.",
    diploma: ["BA"]
  },
  {
    ciclo: 10,
    curso: "ESTRATEGIA DE INTELIGENCIA EMPRESARIAL",
    codigo: "560083",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a situaciones empresariales mediante el an√°lisis de datos. Esta asignatura aborda los conceptos b√°sicos de Business Analytics, los fundamentos de la gesti√≥n y manipulaci√≥n de datos, las t√©cnicas para describir y resumir datos, los modelos predictivos y herramientas para la optimizaci√≥n de decisiones empresariales.",
    diploma: ["BA"]
  },
  {
    ciclo: 10,
    curso: "ROBOTIC PROCESS AUTOMATION",
    codigo: "560092",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante utiliza herramientas anal√≠ticas para automatizar tareas de baja complejidad. Esta asignatura emplea aulas de c√≥mputo y aborda la captura de datos de m√∫ltiples fuentes y las reglas para su procesamiento, modelos de decisi√≥n simples basados en reglas l√≥gicas predefinidas y la interacci√≥n con otros sistemas y aplicaciones.",
    diploma: ["BA"]
  },
  {
    ciclo: 9,
    curso: "MACHINE LEARNING",
    codigo: "560093",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante analiza los resultados de modelos centrados en el aprendizaje aut√≥nomo de las m√°quinas a partir de datos. Esta asignatura emplea aulas de c√≥mputo y aborda m√©todos de aprendizaje supervisado y no supervisado.",
    diploma: ["BA"]
  },
  {
    ciclo: 9,
    curso: "HERRAMIENTAS INFORM√ÅTICAS",
    codigo: "560094",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a soluciones computacionales a trav√©s del uso de algoritmos para la mejora de los procesos. Esta asignatura emplea aulas de c√≥mputo y aborda diversas herramientas inform√°ticas.",
    diploma: ["BA"]
  },
  {
    ciclo: 9,
    curso: "FORMULACI√ìN Y EVALUACI√ìN DE PROYECTOS",
    codigo: "5662",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a la viabilidad de un proyecto de inversi√≥n. Esta asignatura aborda los conceptos y criterios metodol√≥gicos relacionados a la formulaci√≥n de un proyecto, la estructuraci√≥n de los fondos de capital, los costos y presupuestos, as√≠ como el dimensionamiento de las variables para la toma de decisiones a trav√©s de la generaci√≥n de escenarios econ√≥micos, financieros y sociales.",
    diploma: ["EPM"]
  },
  {
    ciclo: 9,
    curso: "METODOLOG√çAS √ÅGILES",
    codigo: "560032",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a un proyecto a trav√©s del uso de soluciones √°giles y din√°micas para crear equipos y organizaciones que se adaptan r√°pidamente a entornos competitivos. Esta asignatura aborda conceptos como Scrum, Kanban, Lean, XP y DevOps.",
    diploma: ["EPM"]
  },
  {
    ciclo: 10,
    curso: "DIRECCI√ìN EN IMPLEMENTACI√ìN DE PROYECTOS",
    codigo: "560035",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante aplica una metodolog√≠a de implementaci√≥n de proyectos. Esta asignatura aborda la identificaci√≥n, priorizaci√≥n y programaci√≥n de actividades, PERT-CPM, la ejecuci√≥n y control de tiempos, costos, calidad y riesgos de los recursos asignados a un proyecto.",
    diploma: ["EPM"]
  },
  {
    ciclo: 8,
    curso: "GESTI√ìN DE OPERACIONES DE SERVICIOS",
    codigo: "5685",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a estrategias para gestionar y optimizar las operaciones de una empresa de servicios a trav√©s del uso de herramientas de ingenier√≠a. Esta asignatura aborda la participaci√≥n del cliente en los procesos de servicio, posicionamiento en mercados competitivos, creaci√≥n de servicios con valor agregado, dise√±o de sistemas de entrega, administraci√≥n de la demanda y capacidad, overbooking y blueprint, administraci√≥n de quejas y recuperaci√≥n del servicio.",
    diploma: ["EPM"]
  },
  {
    ciclo: 10,
    curso: "GESTI√ìN DE RECURSOS",
    codigo: "560098",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante aplica la gesti√≥n de recursos del proyecto siguiendo la metodolog√≠a del PMBOK. Esta asignatura aborda conceptos de operaciones y productividad, recursos en gesti√≥n de proyectos, recursos humanos y dise√±o de trabajos, cadena de suministro, gesti√≥n de inventario y programaci√≥n",
    diploma: ["EPM"]
  },
  {
    ciclo: 10,
    curso: "GESTI√ìN DE RIESGOS Y PORTAFOLIOS",
    codigo: "560099",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante aplica la gesti√≥n de riesgos del proyecto siguiendo la metodolog√≠a del PMBOK. Esta asignatura aborda la identificaci√≥n de riesgos, la gesti√≥n cualitativa, cuantitativa, el tratamiento de riesgos, el seguimiento y la revisi√≥n de los procesos del proyecto.",
    diploma: ["EPM"]
  },
  {
    ciclo: 10,
    curso: "JUEGO DE NEGOCIOS",
    codigo: "5673",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a el desempe√±o del negocio. Esta asignatura aborda sesiones de juego mediante un simulador y software especializado que permiten relacionar, a trav√©s de herramientas, las diversas √°reas de una empresa como planeaci√≥n, ventas, producci√≥n y su efecto en el resultado financiero.",
    diploma: ["SCM","IE"]
  },
  {
    ciclo: 9,
    curso: "GESTI√ìN DEL COMERCIO INTERNACIONAL",
    codigo: "560087",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
      "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a los mecanismos relacionados al comercio internacional. Esta asignatura aborda los fundamentos y procedimientos del comercio internacional, log√≠stica internacional, fletes, seguros, aranceles, medios de pago y financiamiento internacional. Asimismo,	explora el desarrollo y promoci√≥n de exportaciones, considerando los reg√≠menesespeciales en el comercio internacional.", 
    diploma: ["IE"]
  },
  {
    ciclo: 8,
    curso: "CREATIVIDAD, INNOVACI√ìN Y EMPRENDIMIENTO",
    codigo: "560088",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
     "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a productos o servicios innovadores, a trav√©s del an√°lisis de las caracter√≠sticas y oportunidades para el desarrollo de emprendimientos. Esta asignatura explora el proceso de creatividad, las metodolog√≠as y herramientas de innovaci√≥n y las t√©cnicas de prototipado. Asimismo, aborda 	las competencias emprendedoras y t√©cnicas creativas.",
    diploma: ["IE"]
  },
  {
    ciclo: 10,
    curso: "GERENCIA B2B",
    codigo: "560029",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a la gesti√≥n de clientes empresariales para mejorar los resultados de los equipos comerciales. Esta asignatura aborda temas como segmentaci√≥n empresarial de clientes, marketing industrial, trade marketing institucional, el proceso de ventas, ventas consultivas y el desarrollo de 	estrategias comerciales B2B.",
    diploma: ["IE"]
  },
  {
    ciclo: 9,
    curso: "HERRAMIENTAS DE MARKETING DIGITAL",
    codigo: "560005",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante crea estrategias de marketing digital para la captaci√≥n de potenciales clientes y su fidelizaci√≥n. Esta asignatura aborda herramientas del marketing digital como el SMO (Social Media Optimization), SEM (Search Engine Marketing) y SEO (Search Engine Optimization). As√≠ como la gesti√≥n 	de redes sociales, la gesti√≥n de procesos digitales e inboud marketing",
    diploma: ["IE"]
  },
  {
    ciclo: 10,
    curso: "SOSTENIBILIDAD INDUSTRIAL",
    codigo: "560100",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante analiza los conceptos relacionados con la sostenibilidad y su importancia en el contexto global y local, a trav√©s del impacto de las ODS en la gesti√≥n de las organizaciones. Esta asignatura aborda cada una de las dimensiones del desarrollo sostenible, as√≠ como la relaci√≥n entre 	desarrollo sostenible y responsabilidad social.",
    diploma: ["IE"]
  },
  {
    ciclo: 9,
    curso: "GESTI√ìN DE PROYECTOS DE DISE√ëO",
    codigo: "560079",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante elabora proyectos de dise√±o para el mercado de un nuevo producto. Esta asignatura aborda conceptos de proyectos, planificaci√≥n y control de proyectos, presupuesto y c√°lculo de costos, viabilidad y gesti√≥n de proyectos.",
    diploma: ["IT"]
  },
  {
    ciclo: 8,
    curso: "TECNOLOG√çA INDUSTRIAL",
    codigo: "560080",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante aplica las operaciones y procesos industriales para el procesamiento de materiales y productos. Esta asignatura aborda las t√©cnicas de diagrama de flujo, de bloques, m√©todos de tratamiento de agua, fuentes de energ√≠a, m√©todos de obtenci√≥n de gases industriales, fabricaci√≥n de 	fertilizantes, cementos, detergentes y producci√≥n de pl√°sticos.",
    diploma: ["IT"]
  },
  {
    ciclo: 10,
    curso: "DISE√ëO DE PROYECTOS SOSTENIBLES",
    codigo: "560089",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
	  "Es una asignatura de naturaleza te√≥rico-pr√°ctica, en la que el estudiante dise√±a proyectos empresariales sostenibles y con responsabilidad social. Esta asignatura aborda herramientas de gesti√≥n de proyectos, metodolog√≠as y habilidades para la incorporaci√≥n de expectativas de grupos de inter√©s, y los conceptos de sostenibilidad, triple l√≠nea 	base e impacto de los proyectos.",
    diploma: ["IT"]
  },
  {
    ciclo: 10,
    curso: "TECNOLOG√çAS DE PROGRAMACI√ìN",
    codigo: "560090",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rico-pr√°ctica, en la que el estudiante explica los conceptos b√°sicos de la construcci√≥n de software para computadoras. Esta asignatura aborda variables, flujos de datos, planteamiento de algoritmos, t√©cnicas de an√°lisis de algoritmo, estructura b√°sica de datos, algoritmos de b√∫squeda y algoritmos de ordenamiento e interacci√≥n con archivos.",
    diploma: ["IT"]
  },
  {
    ciclo: 9,
    curso: "DISE√ëO Y PROTOTIPADO",
    codigo: "560091",
    creditos: 3,
    prerrequisitos: ["Ingenier√≠a Financiera","Dise√±o de Instalaciones","Inteligencia de Negocios","Modelos de Sistemas Log√≠sticos","Calidad","Procesos de Manufactura"],
    descripcion:
	  "Es una asignatura de naturaleza te√≥rica, en la que el estudiante produce prototipos de productos y maquetas interactivas de sitios web o aplicaciones m√≥viles. Esta asignatura aborda tipos de impresi√≥n de prototipado como modelado por deposici√≥n fundida (FDM), sinterizado selectivo por l√°ser (SLS), estereolitograf√≠a (SLA), impresi√≥n 3D de gran acabado y precisi√≥n (Polyjet) y fabricaci√≥n aditiva con pl√°stico en polvo (3DP).",
    diploma: ["IT"]
  },
  {
    ciclo: 9,
    curso: "SUPPLY CHAIN MANAGEMENT",
    codigo: "560084",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante construye redes de la cadena de suministros. Esta asignatura aborda de manera integrada los conceptos de producci√≥n, el control de inventario, la selecci√≥n de proveedores, la gesti√≥n de riesgos y el dise√±o de la red log√≠stica.",
    diploma: ["SCM"]
  },
  {
    ciclo: 9,
    curso: "COMPRAS Y GESTI√ìN DEL ABASTECIMIENTO",
    codigo: "560085",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a el dise√±o del sistema de flujo de materiales. Esta asignatura aborda los conceptos como la ubicaci√≥n de las instalaciones, los sistemas de aprovisionamiento y los sistemas de almac√©n/inventario",
    diploma: ["SCM"]
  },
  {
    ciclo: 8,
    curso: "LEAN SIX SIGMA",
    codigo: "560095",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante aplica herramientas Lean y Six Sigma sobre problemas de producci√≥n. Esta asignatura aborda conceptos de Lean, como 5S¬¥s, flujo continuo, SMED, mecanismos Poka Yoke, Kanban, mapeo de la cadena de valor, mejora continua Kaizen; y la metodolog√≠a DMAIC.",
    diploma: ["SCM"]
  },
  {
    ciclo: 10,
    curso: "PROCESOS LOG√çSTICOS ERP/ ERP PROCESS WORKSHOP",
    codigo: "560096",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripcion:
    "La asignatura de naturaleza te√≥rico, en la que el estudiante dise√±a procesos log√≠sticos en un sistema ERP. Esta asignatura aborda conceptos como la creaci√≥n de data maestra, proceso de compras, gesti√≥n de demanda, planeamiento (MPS/MRP) y producci√≥n.",
    diploma: ["SCM"]
  },
  {
    ciclo: 10,
    curso: "INGENIER√çA DEL TRANSPORTE Y DISTRIBUCI√ìN",
    codigo: "560097",
    creditos: 3,
    prerrequisitos: ["cr√©ditos:120"],
    descripci√≥n:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante eval√∫a el dise√±o del sistema de flujo de materiales hacia los clientes. Esta asignatura aborda los conceptos como la ubicaci√≥n de los centros de distribuci√≥n y los sistemas de distribuci√≥n/transporte.",
    diploma: ["SCM"]
  },
  {
  ciclo: 6,
  curso: "GLOBALIZACI√ìN, CAPITALISMO Y CIENCIA EN EL MUNDO CONTEMPOR√ÅNEO",
  codigo: "560075",
  creditos: 3,
  prerrequisitos: ["cr√©ditos:80"],
  descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante examina la relaci√≥n de los problemas del mundo contempor√°neo y la situaci√≥n actual del Per√∫ con un √©nfasis en la revoluci√≥n industrial y tecnol√≥gica actual. Esta asignatura aborda los principales procesos y fen√≥menos que han surgido desde la guerra fr√≠a, la consolidaci√≥n de la globalizaci√≥n, la influencia del capitalismo mundial, los avances cient√≠ficos en la sociedad, la cultura y geopol√≠tica actual.",
  diploma: ["Sin Diploma"]
},
{
  ciclo: 6,
  curso: "TALLER DE LIDERAZGO",
  codigo: "560076",
  creditos: 3,
  prerrequisitos: ["cr√©ditos:80"],
  descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante utiliza herramientas y recursos que permiten el cambio y la transformaci√≥n de la persona. Esta asignatura aborda temas como perfiles de liderazgo, marketing personal, comunicaci√≥n asertiva, desarrollo de habilidades personales, inteligencia emocional, plan de vida, motivaciones y metas personales.",
  diploma: ["Sin Diploma"]
},
{
  ciclo: 6,
  curso: "PROGRAMACI√ìN PARA INGENIER√çA",
  codigo: "560077",
  creditos: 3,
  prerrequisitos: ["cr√©ditos:80"],
  descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante dise√±a algoritmos y programas de alto nivel. Esta asignatura aborda la programaci√≥n orientada a objetos, la manipulaci√≥n de datos, la conexi√≥n y consulta a bases de datos.",
  diploma: ["Sin Diploma"]
},
{
  ciclo: 7,
  curso: "SISTEMAS DE INFORMACI√ìN GERENCIAL",
  codigo: "560078",
  creditos: 3,
  prerrequisitos: ["cr√©ditos:100"],
  descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante elabora un proyecto de sistemas mediante el uso de una metodolog√≠a de desarrollo. Esta asignatura aborda los recursos que conforman los sistemas y tecnolog√≠as de la informaci√≥n, para el desarrollo de proyectos, cada una con sus propias caracter√≠sticas, enfoques y procesos.",
  diploma: ["Sin Diploma"]
},
{
  ciclo: 7,
  curso: "TALLER DE HABILIDADES GERENCIALES",
  codigo: "5665",
  creditos: 3,
  prerrequisitos: ["cr√©ditos:100"],
  descripcion:
    "Es una asignatura de naturaleza te√≥rica, en la que el estudiante utiliza t√©cnicas, herramientas y recursos que le permiten conseguir metas y objetivos organizacionales. Esta asignatura aborda el pensamiento estrat√©gico, la negociaci√≥n, el manejo de conflictos, la administraci√≥n eficiente del tiempo y el manejo de estr√©s. Adicionalmente, √©sta enfatiza en el coaching y gesti√≥n de equipos en los procesos de cambio.",
  diploma: ["Sin Diploma"]
}

];
let diplomaSeleccionado = "todos";

function renderElectivos() {
  const container = document.getElementById("electivos-container");
  container.innerHTML = "";

cursosElectivos
  .filter(curso =>
    diplomaSeleccionado === 'todos' ||
    (Array.isArray(curso.diploma)
      ? curso.diploma.includes(diplomaSeleccionado)
      : curso.diploma === diplomaSeleccionado) ||
    (diplomaSeleccionado === 'ninguno' && !curso.diploma)
  )
    .forEach(curso => {
      const card = document.createElement("div");
      card.className = "electivo";
      card.setAttribute("draggable", "true");
      card.dataset.curso = curso.curso;
      card.dataset.ciclo = curso.ciclo;

      let badge = "";
      if (Array.isArray(curso.diploma)) {
        badge = curso.diploma.map(sigla =>
          `<span class="badge ${sigla}" title="${nombreDiploma[sigla] || sigla}">${sigla}</span>`
        ).join(" ");
      } else if (curso.diploma && curso.diploma !== "ninguno") {
        badge = `<span class="badge ${curso.diploma}" title="${nombreDiploma[curso.diploma] || curso.diploma}">${curso.diploma}</span>`;
      } else {
        badge = `<span class="badge ninguno" title="Sin diploma">Sin diploma</span>`;
      }

      card.innerHTML = `
        <div class="curso-title">${curso.curso}</div>
        ${badge}
        <small><strong>C√≥digo:</strong> ${curso.codigo}</small>
        <small><strong>Cr√©ditos:</strong> ${curso.creditos}</small>
        <div class="info-btn">i</div>   <!-- ‚úÖ ESTE DIV FALTABA -->
      `;

      card.querySelector(".info-btn").addEventListener("click", e => {
        e.stopPropagation();
        renderPopup(curso);
      });

      card.addEventListener("dragstart", () => {
        card.classList.add("dragging");
      });

      card.addEventListener("dragend", () => {
        card.classList.remove("dragging");
      });

      container.appendChild(card);
    });
}
function agregarEval(event, cursoNombre) {
  event.preventDefault();
  const nombre = document.getElementById("eval-nombre").value;
  const peso = parseFloat(document.getElementById("eval-peso").value) / 100;
  const nota = parseFloat(document.getElementById("eval-nota").value);

  const evaluaciones = JSON.parse(localStorage.getItem("evaluaciones_" + cursoNombre)) || [];
  evaluaciones.push({ nombre, peso, nota });
  localStorage.setItem("evaluaciones_" + cursoNombre, JSON.stringify(evaluaciones));
  renderPopup({ ...carreras[carreraActual].find(c => c.curso === cursoNombre) });
}

function eliminarEval(cursoNombre, index) {
  const evaluaciones = JSON.parse(localStorage.getItem("evaluaciones_" + cursoNombre)) || [];
  evaluaciones.splice(index, 1);
  localStorage.setItem("evaluaciones_" + cursoNombre, JSON.stringify(evaluaciones));
  renderPopup({ ...carreras[carreraActual].find(c => c.curso === cursoNombre) });
}
    function filtrarDiploma(clave) {
      diplomaSeleccionado = clave;
      document.querySelectorAll(".filtros-diplomas button").forEach(btn => btn.classList.remove("active"));
      document.querySelector(`.filtros-diplomas button[onclick*="${clave}"]`).classList.add("active");
      renderElectivos();
    }

    window.onload = () => {
      renderMalla();
      filtrarDiploma("todos");
      mostrarCreditosAprobados();
    };
document.addEventListener("DOMContentLoaded", () => {
  const malla = document.getElementById("malla");

  malla.addEventListener("dragover", e => {
    e.preventDefault();
    const dragged = document.querySelector(".electivo.dragging");
    if (dragged && e.target.closest(".ciclo-col")) {
      const targetCol = e.target.closest(".ciclo-col");
      targetCol.appendChild(dragged);

      const nombreCurso = dragged.dataset.curso;
      const cicloText = targetCol.querySelector(".ciclo-title")?.textContent || "";
      const ciclo = parseInt(cicloText.replace("Ciclo ", "")) || 1;

      const encontrado = cursosElectivos.find(c => c.curso === nombreCurso);
      if (encontrado && !carreras[carreraActual].some(c => c.curso === encontrado.curso)) {
        carreras[carreraActual].push({ ...encontrado, ciclo });
        renderMalla();
        renderElectivos();
        estadoCursos[encontrado.curso] = false;
        localStorage.setItem("estadoCursosULIMA", JSON.stringify(estadoCursos));
      }
    }
  });
});
  // Permitir regresar electivos desde la malla general
function habilitarBotonEliminarElectivo(card, curso) {
  const boton = document.createElement("button");
  boton.innerText = "‚è™";
  boton.title = "Quitar de la malla y devolver a Electivos";
  boton.style.position = "absolute";
  boton.style.bottom = "0.5rem";
  boton.style.left = "0.5rem";
  boton.style.background = "transparent";
  boton.style.border = "none";
  boton.style.cursor = "pointer";
  boton.style.color = "#d94e6a";
  boton.style.fontSize = "14px";

  boton.addEventListener("click", (e) => {
    e.stopPropagation();
    // Eliminar de la malla
    const index = carreras[carreraActual].findIndex(c => c.curso === curso.curso);
    if (index !== -1) {
      carreras[carreraActual].splice(index, 1);
      // Borrar su estado (completado o no)
      delete estadoCursos[curso.curso];
      localStorage.setItem("estadoCursosULIMA", JSON.stringify(estadoCursos));
      renderMalla();
      renderElectivos();
    }
  });

  card.appendChild(boton);
}
function quitarElectivo(nombreCurso) {
  // Eliminar de la malla
  carreras[carreraActual] = carreras[carreraActual].filter(c => c.curso !== nombreCurso);
  
  // Tambi√©n quitar su estado si ten√≠a alguno
  delete estadoCursos[nombreCurso];
  localStorage.setItem("estadoCursosULIMA", JSON.stringify(estadoCursos));

  mostrarCreditosAprobados();
  renderMalla();
  renderElectivos();
}
  </script>
</body>
</html>
